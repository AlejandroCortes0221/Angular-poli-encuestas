<form class="w-full h-screen flex justify-center items-center">

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="w-[80%] max-w-3xl bg-white rounded-xl shadow-xl flex flex-col">

        <!-- HEADER FIJO -->
        <div class="p-6 border-b bg-white sticky top-0 z-10">
            <h2 class="text-2xl font-bold text-gray-800">{{ titulo }}</h2>
            <p class="text-gray-500 text-sm">Disponible hasta: {{ fechaCierre }}</p>
        </div>

        <!-- DESCRIPCIÓN -->
        <div class="px-6 py-4 border-b">
            <p class="font-semibold text-gray-700 mb-2">Descripción:</p>
            <div class="w-full p-3 text-gray-700 bg-gray-100 rounded-lg border whitespace-pre-wrap">
                {{ descripcion }}
            </div>
        </div>

        <!-- SCROLL DE PREGUNTAS -->
        <div class="overflow-y-auto px-6 py-4" style="max-height: 60vh;">

            @for (pregunta of preguntas; let i = $index; track i) {

            <div class="mb-6 pb-4 border-b">

                <!-- TEXTO DE LA PREGUNTA -->
                <h3 class="text-lg font-semibold text-gray-800 mb-3">
                    {{ pregunta.texto }}
                </h3>

                <!-- MULTIPLE - RADIO -->
                @if (pregunta.tipo === 'multiple') {
                <div class="space-y-2">

                    @for (opcion of pregunta.opciones; let idx = $index; track idx) {

                    <label class="flex items-center gap-3 cursor-pointer">
                        <input 
                            type="radio"
                            class="w-4 h-4 accent-indigo-600"
                            [name]="'pregunta_' + i"
                            [value]="opcion"
                            [(ngModel)]="pregunta.seleccionada"
                        >
                        <span class="text-gray-700">{{ opcion }}</span>
                    </label>

                    }

                </div>
                }

                <!-- TEXTO -->
                @else {
                <input 
                    type="text"
                    name="pregunta_{{ i }}"
                    class="w-full mt-2 p-2 border rounded-lg bg-gray-100 focus:outline-none focus:ring-2 focus:ring-indigo-500"
                    placeholder="Escribe tu respuesta"
                    [(ngModel)]="pregunta.respuesta"
                >
                }

                <!-- MENSAJE DE ERROR -->
                @if (errores[i]) {
                    <p class="text-red-600 text-sm mt-2">{{ errores[i] }}</p>
                }

            </div>

            }

        </div>

        <!-- BOTÓN INFERIOR FIJO -->
        <div class="p-4 border-t bg-white sticky bottom-0 flex justify-center">
            <button
                type="button"
                class="bg-indigo-600 text-white font-semibold py-3 px-8 rounded-lg hover:bg-indigo-700 transition cursor-pointer"
                (click)="enviarRespuestas()"
            >
                Guardar respuestas
            </button>
        </div>

    </div>

</form>
<loading [type]="popupType" [message]="popupMessage()"></loading>